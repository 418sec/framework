#!/usr/bin/env node

// Copyright 2012-2014 (c) Peter Å irka <petersirka@gmail.com>
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

var exec=require("child_process").exec;var fs=require("fs");var path=require("path");var os=require("os");var EOF=os.platform()==="win32"?"\r\n":"\n";var $type=1;function createDirectory(directory){var arr=[];arr.push("controllers");arr.push("node_modules");if($type<2){arr.push("views");arr.push("definitions");if($type==0){arr.push("databases");arr.push("workers");arr.push("tests");arr.push("logs");arr.push("modules");arr.push("source");arr.push("resources")}arr.push("public")}arr.forEach(function(o){var dir=path.join(directory,o);if(!fs.existsSync(dir))fs.mkdirSync(dir)})}function createDirectoryAngular(directory){var arr=[];arr.push("app");arr.push("controllers");arr.push("definitions");arr.push("node_modules");arr.push("views");arr.forEach(function(o){var dir=path.join(directory,o);if(!fs.existsSync(dir))fs.mkdirSync(dir)});arr=[];arr.push("common");arr.push("controllers");arr.push("css");arr.push("directives");arr.push("filters");arr.push("resources");arr.push("services");arr.push("templates");arr.push("views");arr.forEach(function(o){var dir=path.join(directory,"app",o);if(!fs.existsSync(dir))fs.mkdirSync(dir)})}function createFiles(directory){createFileIndex(directory);createFileConfig(directory);if($type<2){createFileDefinitions(directory);createFileViews(directory);createFilePublic(directory)}if($type===3){createFileViews(directory);createFilePublicAngular(directory);createFileControllerAngular(directory)}else createFileController(directory);if($type===0){createFileTest(directory);createFileModules(directory)}}function createFileIndex(directory){fs.writeFileSync(path.join(directory,"debug.js"),"Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQovLyBJTVBPUlRBTlQ6IG9ubHkgZm9yIGRldmVsb3BtZW50DQovLyB0b3RhbC5qcyAtIHdlYiBhcHBsaWNhdGlvbiBmcmFtZXdvcmsgZm9yIG5vZGUuanMNCi8vIGh0dHA6Ly93d3cudG90YWxqcy5jb20NCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KDQp2YXIgZnMgPSByZXF1aXJlKCdmcycpOw0KdmFyIG9wdGlvbnMgPSB7fTsNCg0KLy8gb3B0aW9ucy5pcCA9ICcxMjcuMC4wLjEnOw0KLy8gb3B0aW9ucy5wb3J0ID0gcGFyc2VJbnQocHJvY2Vzcy5hcmd2WzJdKTsNCi8vIG9wdGlvbnMuY29uZmlnID0geyBuYW1lOiAndG90YWwuanMnIH07DQovLyBvcHRpb25zLmh0dHBzID0geyBrZXk6IGZzLnJlYWRGaWxlU3luYygna2V5cy9hZ2VudDIta2V5LnBlbScpLCBjZXJ0OiBmcy5yZWFkRmlsZVN5bmMoJ2tleXMvYWdlbnQyLWNlcnQucGVtJyl9Ow0KDQovKioNCiAqIFJlbGVhc2Ugbm90ZXM6DQogKi8NCg0KdmFyIGlzRGVidWdnaW5nPXByb2Nlc3MuYXJndi5pbmRleE9mKCJkZWJ1Z2dpbmciKSE9PS0xO3ZhciBkaXJlY3Rvcnk9cHJvY2Vzcy5jd2QoKTt2YXIgcGF0aD1yZXF1aXJlKCJwYXRoIik7dmFyIGZpcnN0PXByb2Nlc3MuYXJndi5pbmRleE9mKCJyZXN0YXJ0Iik9PT0tMTtmdW5jdGlvbiBkZWJ1Zygpe3ZhciBmcmFtZXdvcms9cmVxdWlyZSgidG90YWwuanMiKTt2YXIgcG9ydD1wYXJzZUludChwcm9jZXNzLmFyZ3ZbMl0pO2lmKG9wdGlvbnMuaHR0cHMpcmV0dXJuIGZyYW1ld29yay5odHRwcygiZGVidWciLG9wdGlvbnMpO2ZyYW1ld29yay5odHRwKCJkZWJ1ZyIsb3B0aW9ucyk7aWYoZmlyc3QpZnJhbWV3b3JrLmVtaXQoImRlYnVnLXN0YXJ0Iik7ZWxzZSBmcmFtZXdvcmsuZW1pdCgiZGVidWctcmVzdGFydCIpfWZ1bmN0aW9uIGFwcCgpe3ZhciBmb3JrPXJlcXVpcmUoImNoaWxkX3Byb2Nlc3MiKS5mb3JrO3ZhciB1dGlscz1yZXF1aXJlKCJ0b3RhbC5qcy91dGlscyIpO3ZhciBkaXJlY3Rvcmllcz1bZGlyZWN0b3J5KyIvY29udHJvbGxlcnMiLGRpcmVjdG9yeSsiL2RlZmluaXRpb25zIixkaXJlY3RvcnkrIi9tb2R1bGVzIixkaXJlY3RvcnkrIi9yZXNvdXJjZXMiLGRpcmVjdG9yeSsiL2NvbXBvbmVudHMiLGRpcmVjdG9yeSsiL21vZGVscyIsZGlyZWN0b3J5KyIvc291cmNlIl07dmFyIGZpbGVzPXt9O3ZhciBmb3JjZT1mYWxzZTt2YXIgY2hhbmdlcz1bXTt2YXIgYXBwPW51bGw7dmFyIHN0YXR1cz0wO3ZhciBhc3luYz1uZXcgdXRpbHMuQXN5bmM7dmFyIHBpZD0iIjt2YXIgcGlkSW50ZXJ2YWw9bnVsbDt2YXIgcHJlZml4PSItLS0tLS0tLS0tLS0+ICI7dmFyIGlzTG9hZGVkPWZhbHNlO2Z1bmN0aW9uIG9uRmlsdGVyKHBhdGgsaXNEaXJlY3Rvcnkpe3JldHVybiBpc0RpcmVjdG9yeT90cnVlOnBhdGguaW5kZXhPZigiLmpzIikhPT0tMXx8cGF0aC5pbmRleE9mKCIucmVzb3VyY2UiKSE9PS0xfWZ1bmN0aW9uIG9uQ29tcGxldGUoKXt2YXIgc2VsZj10aGlzO2ZzLnJlYWRkaXIoZGlyZWN0b3J5LGZ1bmN0aW9uKGVycixhcnIpe3ZhciBsZW5ndGg9YXJyLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3ZhciBuYW1lPWFycltpXTtpZihuYW1lPT09ImNvbmZpZyJ8fG5hbWU9PT0iY29uZmlnLWRlYnVnInx8bmFtZT09PSJjb25maWctcmVsZWFzZSJ8fG5hbWU9PT0idmVyc2lvbnMifHxuYW1lLmluZGV4T2YoIi5qcyIpIT09LTF8fG5hbWUuaW5kZXhPZigiLnJlc291cmNlIikhPT0tMSlzZWxmLmZpbGUucHVzaChuYW1lKX1sZW5ndGg9c2VsZi5maWxlLmxlbmd0aDtmb3IodmFyIGk9MDtpPGxlbmd0aDtpKyspe3ZhciBuYW1lPXNlbGYuZmlsZVtpXTtpZighZmlsZXNbbmFtZV0pZmlsZXNbbmFtZV09aXNMb2FkZWQ/MDpudWxsfXJlZnJlc2goKX0pfWZ1bmN0aW9uIHJlZnJlc2goKXt2YXIgZmlsZW5hbWVzPU9iamVjdC5rZXlzKGZpbGVzKTt2YXIgbGVuZ3RoPWZpbGVuYW1lcy5sZW5ndGg7Zm9yKHZhciBpPTA7aTxsZW5ndGg7aSsrKXt2YXIgZmlsZW5hbWU9ZmlsZW5hbWVzW2ldOyhmdW5jdGlvbihmaWxlbmFtZSl7YXN5bmMuYXdhaXQoZnVuY3Rpb24obmV4dCl7ZnMuc3RhdChmaWxlbmFtZSxmdW5jdGlvbihlcnIsc3RhdCl7aWYoIWVycil7dmFyIHRpY2tzPXN0YXQubXRpbWUuZ2V0VGltZSgpO2lmKGZpbGVzW2ZpbGVuYW1lXSE9PW51bGwmJmZpbGVzW2ZpbGVuYW1lXSE9PXRpY2tzKXtjaGFuZ2VzLnB1c2gocHJlZml4K2ZpbGVuYW1lLnJlcGxhY2UoZGlyZWN0b3J5LCIiKSsoZmlsZXNbZmlsZW5hbWVdPT09MD8iIChhZGRlZCkiOiIgKG1vZGlmaWVkKSIpKTtmb3JjZT10cnVlfWZpbGVzW2ZpbGVuYW1lXT10aWNrc31lbHNle2RlbGV0ZSBmaWxlc1tmaWxlbmFtZV07Y2hhbmdlcy5wdXNoKHByZWZpeCtmaWxlbmFtZS5yZXBsYWNlKGRpcmVjdG9yeSwiIikrIiAocmVtb3ZlZCkiKTtmb3JjZT10cnVlfW5leHQoKX0pfSl9KShmaWxlbmFtZSl9YXN5bmMuY29tcGxldGUoZnVuY3Rpb24oKXtpc0xvYWRlZD10cnVlO3NldFRpbWVvdXQocmVmcmVzaF9kaXJlY3RvcnksMmUzKTtpZihzdGF0dXMhPT0xKXJldHVybjtpZighZm9yY2UpcmV0dXJuO3Jlc3RhcnQoKTt2YXIgbGVuZ3RoPWNoYW5nZXMubGVuZ3RoO2Zvcih2YXIgaT0wO2k8bGVuZ3RoO2krKyljb25zb2xlLmxvZyhjaGFuZ2VzW2ldKTtjaGFuZ2VzPVtdO2ZvcmNlPWZhbHNlfSl9ZnVuY3Rpb24gcmVmcmVzaF9kaXJlY3RvcnkoKXt1dGlscy5scyhkaXJlY3RvcmllcyxvbkNvbXBsZXRlLG9uRmlsdGVyKX1mdW5jdGlvbiByZXN0YXJ0KCl7aWYoYXBwIT09bnVsbCl7dHJ5e3Byb2Nlc3Mua2lsbChhcHAucGlkKX1jYXRjaChlcnIpe31hcHA9bnVsbH12YXIgYXJyPXByb2Nlc3MuYXJndjthcnIucG9wKCk7aWYoZmlyc3QpZmlyc3Q9ZmFsc2U7ZWxzZSBhcnIucHVzaCgicmVzdGFydCIpO2Fyci5wdXNoKCJkZWJ1Z2dpbmciKTthcHA9Zm9yayhwYXRoLmpvaW4oZGlyZWN0b3J5LCJkZWJ1Zy5qcyIpLGFycik7YXBwLm9uKCJtZXNzYWdlIixmdW5jdGlvbihtc2cpe2lmKG1zZy5zdWJzdHJpbmcoMCw1KT09PSJuYW1lOiIpe3Byb2Nlc3MudGl0bGU9ImRlYnVnOiAiK21zZy5zdWJzdHJpbmcoNik7cmV0dXJufWlmKG1zZz09PSJlYWRkcmludXNlIilwcm9jZXNzLmV4aXQoMSl9KTthcHAub24oImV4aXQiLGZ1bmN0aW9uKCl7aWYoc3RhdHVzIT09MjU1KXJldHVybjthcHA9bnVsbH0pO2lmKHN0YXR1cz09PTApYXBwLnNlbmQoImRlYnVnZ2luZyIpO3N0YXR1cz0xfXByb2Nlc3Mub24oIlNJR1RFUk0iLGVuZCk7cHJvY2Vzcy5vbigiU0lHSU5UIixlbmQpO3Byb2Nlc3Mub24oImV4aXQiLGVuZCk7ZnVuY3Rpb24gZW5kKCl7aWYoYXJndW1lbnRzLmNhbGxlZS5pc0VuZClyZXR1cm47YXJndW1lbnRzLmNhbGxlZS5pc0VuZD10cnVlO2ZzLnVubGluayhwaWQsbm9vcCk7aWYoYXBwPT09bnVsbCl7cHJvY2Vzcy5leGl0KDApO3JldHVybn1wcm9jZXNzLmtpbGwoYXBwLnBpZCk7YXBwPW51bGw7cHJvY2Vzcy5leGl0KDApfWZ1bmN0aW9uIG5vb3AoKXt9aWYocHJvY2Vzcy5waWQ+MCl7Y29uc29sZS5sb2cocHJlZml4KyJQSUQ6ICIrcHJvY2Vzcy5waWQpO3BpZD1wYXRoLmpvaW4oZGlyZWN0b3J5LCJkZWJ1Zy5waWQiKTtmcy53cml0ZUZpbGVTeW5jKHBpZCxwcm9jZXNzLnBpZCk7cGlkSW50ZXJ2YWw9c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtmcy5leGlzdHMocGlkLGZ1bmN0aW9uKGV4aXN0KXtpZihleGlzdClyZXR1cm47ZnMudW5saW5rKHBpZCxub29wKTtpZihhcHAhPT1udWxsKXByb2Nlc3Mua2lsbChhcHAucGlkKTtwcm9jZXNzLmV4aXQoMCl9KX0sMmUzKX1yZXN0YXJ0KCk7cmVmcmVzaF9kaXJlY3RvcnkoKX1mdW5jdGlvbiBydW4oKXtpZihpc0RlYnVnZ2luZyl7ZGVidWcoKTtyZXR1cm59dmFyIGZpbGVuYW1lPXBhdGguam9pbihkaXJlY3RvcnksImRlYnVnLnBpZCIpO2lmKCFmcy5leGlzdHNTeW5jKGZpbGVuYW1lKSl7YXBwKCk7cmV0dXJufWZzLnVubGlua1N5bmMoZmlsZW5hbWUpO3NldFRpbWVvdXQoZnVuY3Rpb24oKXthcHAoKX0sM2UzKX1ydW4oKTs=","base64");fs.writeFileSync(path.join(directory,"release.js"),"Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQovLyBJTVBPUlRBTlQ6IG9ubHkgZm9yIHByb2R1Y3Rpb24NCi8vIHRvdGFsLmpzIC0gd2ViIGFwcGxpY2F0aW9uIGZyYW1ld29yayBmb3Igbm9kZS5qcw0KLy8gaHR0cDovL3d3dy50b3RhbGpzLmNvbQ0KLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7DQp2YXIgb3B0aW9ucyA9IHt9Ow0KDQovLyBvcHRpb25zLmlwID0gJzEyNy4wLjAuMSc7DQovLyBvcHRpb25zLnBvcnQgPSBwYXJzZUludChwcm9jZXNzLmFyZ3ZbMl0pOw0KLy8gb3B0aW9ucy5jb25maWcgPSB7IG5hbWU6ICd0b3RhbC5qcycgfTsNCi8vIG9wdGlvbnMuaHR0cHMgPSB7IGtleTogZnMucmVhZEZpbGVTeW5jKCdrZXlzL2FnZW50Mi1rZXkucGVtJyksIGNlcnQ6IGZzLnJlYWRGaWxlU3luYygna2V5cy9hZ2VudDItY2VydC5wZW0nKX07DQoNCi8qKg0KICogUmVsZWFzZSBub3RlczoNCiAqLw0KDQpyZXF1aXJlKCd0b3RhbC5qcycpLmh0dHAoJ3JlbGVhc2UnLCBvcHRpb25zKTsNCi8vIHJlcXVpcmUoJ3RvdGFsLmpzJykuaHR0cHMoJ3JlbGVhc2UnLCBvcHRpb25zKTs=","base64");fs.writeFileSync(path.join(directory,"test.js"),"Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQovLyBJTVBPUlRBTlQ6IG9ubHkgZm9yIHRlc3RpbmcNCi8vIHRvdGFsLmpzIC0gd2ViIGFwcGxpY2F0aW9uIGZyYW1ld29yayBmb3Igbm9kZS5qcw0KLy8gaHR0cDovL3d3dy50b3RhbGpzLmNvbQ0KLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQoNCnZhciBmcyA9IHJlcXVpcmUoJ2ZzJyk7DQp2YXIgb3B0aW9ucyA9IHt9Ow0KDQovLyBvcHRpb25zLnRlc3RzID0gWydjb250cm9sbGVycycsICdtb2R1bGVzJ107DQovLyBvcHRpb25zLmlwID0gJzEyNy4wLjAuMSc7DQovLyBvcHRpb25zLnBvcnQgPSBwYXJzZUludChwcm9jZXNzLmFyZ3ZbMl0pOw0KLy8gb3B0aW9ucy5jb25maWcgPSB7IG5hbWU6ICd0b3RhbC5qcycgfTsNCi8vIG9wdGlvbnMuaHR0cHMgPSB7IGtleTogZnMucmVhZEZpbGVTeW5jKCdrZXlzL2FnZW50Mi1rZXkucGVtJyksIGNlcnQ6IGZzLnJlYWRGaWxlU3luYygna2V5cy9hZ2VudDItY2VydC5wZW0nKX07DQoNCi8qKg0KICogUmVsZWFzZSBub3RlczoNCiAqLw0KDQpyZXF1aXJlKCd0b3RhbC5qcycpLmh0dHAoJ3Rlc3QnLCBvcHRpb25zKTsNCi8vIHJlcXVpcmUoJ3RvdGFsLmpzJykuaHR0cHMoJ3Rlc3QnLCBvcHRpb25zKTs=","base64")}function createFileDefinitions(directory){fs.writeFileSync(path.join(directory,"definitions","modules.js"),"LyoqDQogKiBFeHRlcm5hbCBtb2R1bGVzDQogKi8NCg0KLy8gUmVhbC10aW1lIHdlYiB0cmFja2luZw0KSU5TVEFMTCgnbW9kdWxlJywgJ2h0dHBzOi8vbW9kdWxlcy50b3RhbGpzLmNvbS93ZWJjb3VudGVyL3YxLjAwL3dlYmNvdW50ZXIuanMnLCB7IHVybDogJy93ZWJjb3VudGVyLycgfSk7DQoNCi8vIEEgc2ltcGxlIERET1MgcHJvdGVjdGlvbg0KSU5TVEFMTCgnbW9kdWxlJywgJ2h0dHBzOi8vbW9kdWxlcy50b3RhbGpzLmNvbS9kZG9zL3YxLjAwL2Rkb3MuanMnKTs=","base64")}function createFileConfig(directory){var buffer=[];buffer.push("name                     : My web site");buffer.push("version                  : 1.01");buffer.push("author                   : Your company name");buffer.push("secret                   : your-secret-key");buffer.push("");buffer.push("// Mail settings");buffer.push("mail.smtp                : smtp.yourwebsite.com");buffer.push('mail.smtp.options        : "{"secure":false,"port":25,"user":"","password":"","timeout":10000}"');buffer.push("mail.address.from        : your@yourwebsite.com");buffer.push("mail.address.reply       : your@yourwebsite.com");buffer.push("mail.address.bcc         : ");fs.writeFileSync(path.join(directory,"config"),buffer.join(EOF));buffer=[];buffer.push("default-ip               : 127.0.0.1");buffer.push("default-port             : 8000");buffer.push("");fs.writeFileSync(path.join(directory,"config-release"),buffer.join(EOF));fs.writeFileSync(path.join(directory,"config-debug"),buffer.join(EOF).replace(/true/g,"false"));if($type!==2)fs.writeFileSync(path.join(directory,"config-test"),"")}function createFileViews(directory){var buffer=[];var dir=path.join(directory,"views");if(!fs.existsSync(dir))fs.mkdirSync(dir);if($type!==3){buffer.push("@{meta('title', 'description', 'keywords')}");buffer.push("");buffer.push("<div>Hello world!</div>");fs.writeFileSync(path.join(dir,"index.html"),buffer.join("\n"))}buffer=[];if($type===3){buffer.push("@{layout('')}");buffer.push("@{meta('title', 'description', 'keywords')}");buffer.push("");buffer.push("@{ng('angular', 'resource', 'route')}");buffer.push("");buffer.push("<!-- /app/css/ -->");buffer.push("@{ngStyle('app')}");buffer.push("");buffer.push("<!-- cdnjs -->");buffer.push("@{ngLocale('en-us')}");buffer.push("");buffer.push("<!-- /app/controllers/ -->");buffer.push("@{ngController('home', 'user')}");buffer.push("")}buffer.push("<!DOCTYPE html>");if($type===3)buffer.push('<html ng-app="app">');else buffer.push("<html>");buffer.push("<head>");buffer.push("    @{meta}");buffer.push('    <meta charset="utf-8" />');buffer.push('    <meta http-equiv="X-UA-Compatible" content="IE=10" />');buffer.push('    <meta name="format-detection" content="telephone=no" />');buffer.push('    <meta name="viewport" content="width=1024, user-scalable=yes" />');buffer.push('    <meta name="robots" content="all,follow" />');buffer.push("    @{head}");if($type!==3){buffer.push("    @{css('default.css')}");buffer.push('    <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>');buffer.push("    @{js('default.js')}")}buffer.push("    @{favicon('favicon.ico')}");buffer.push("</head>");buffer.push("<body>");buffer.push("");if($type===3)buffer.push('    <div ng-controller="HomeCtrl">{{ name }}</div>');else buffer.push("    @{body}");buffer.push("");buffer.push("</body>");buffer.push("</html>");fs.writeFileSync(path.join(dir,$type===3?"app.html":"layout.html"),buffer.join(EOF))}function createFileResource(directory){var dir=path.join(directory,"resources");fs.writeFileSync(path.join(dir,"default.resource"),"name                : value"+EOF)}function createFilePublicAngular(directory){var dir=path.join(directory,"app");var modules=path.join(directory,"modules");var css=path.join(dir,"css");var controllers=path.join(dir,"controllers");var buffer=[];fs.mkdirSync(modules);buffer.push("User-agent: *");buffer.push("Allow: /");buffer.push("");fs.writeFileSync(path.join(dir,"robots.txt"),buffer.join(EOF));fs.writeFileSync(path.join(css,"app.css"),"LyphdXRvKi8NCg0KLyoNCiAgICB2YXIgY29sb3IgPSAnY29sb3I6cmVkJzsNCiAgICB2YXIgd2lkdGggPSAnOTQwcHgnOw0KKi8NCg0KYm9keSB7IHBhZGRpbmc6MjBweDsgbWFyZ2luOjA7IGZvbnQ6bm9ybWFsIDEycHggQXJpYWw7IGNvbG9yOiM1MDUwNTA7IH0NCg0KLmNvbnRlbnQgeyBtYXJnaW46MCBhdXRvOyB3aWR0aDogJHdpZHRoOyBwYWRkaW5nOiAxMHB4OyBib3JkZXItcmFkaXVzOiA1cHg7ICRjb2xvcjsgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgwLDAsMCwwLjUpOyBhbmltYXRpb246IG15QW5pbWF0aW9uIDVzIGFsdGVybmF0ZTsgfQ0KDQoubGlzdCB7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNFMEUwRTA7IHBhZGRpbmctYm90dG9tOjVweDsgbWFyZ2luLWJvdHRvbTo1cHg7IH0NCi5saXN0ID4gZGl2OmZpcnN0LWNoaWxkIHsgZm9udC1zaXplOiAxNXB4OyB9DQoNCkBrZXlmcmFtZXMgbXlBbmltYXRpb24NCnsNCgkwJSAgIHsgYmFja2dyb3VuZDogd2hpdGU7IH0NCgkyNSUgIHsgYmFja2dyb3VuZDogI0YwRjBGMDsgfQ0KCTUwJSAgeyBiYWNrZ3JvdW5kOiAjRDBEMEQwOyB9DQoJMTAwJSB7IGJhY2tncm91bmQ6ICNFMEUwRTA7IH0NCn0=","base64");fs.writeFileSync(path.join(modules,"angular.js"),"Ly8gTUlUIExpY2Vuc2UNCi8vIENvcHlyaWdodCBQZXRlciDFoGlya2EgPHBldGVyc2lya2FAZ21haWwuY29tPg0KLy8gVmVyc2lvbiAxLjAxDQoNCmV4cG9ydHMubmFtZSA9ICdhbmd1bGFyLmpzJzsNCmV4cG9ydHMudmVyc2lvbiA9ICcxLjAwJzsNCmV4cG9ydHMub3B0aW9ucyA9IHsgJ2FuZ3VsYXItdmVyc2lvbic6ICcxLjIuMTgnLCAnYW5ndWxhci1pMThuLXZlcnNpb24nOiAnMS4yLjE1JyB9Ow0KDQp2YXIgZnMgPSByZXF1aXJlKCdmcycpOw0KdmFyIEVYVEVOU0lPTl9KUyA9ICcuanMnOw0KdmFyIFJFUE9TSVRPUllfQU5HVUxBUiA9ICckYW5ndWxhcic7DQp2YXIgUkVQT1NJVE9SWV9BTkdVTEFSX0xPQ0FMRSA9ICckYW5ndWxhci1sb2NhbGUnOw0KdmFyIFJFUE9TSVRPUllfQU5HVUxBUl9DT01NT04gPSAnJGFuZ3VsYXItY29tbW9uJzsNCnZhciBSRVBPU0lUT1JZX0FOR1VMQVJfQ09OVFJPTExFUiA9ICckYW5ndWxhci1jb250cm9sbGVyJzsNCnZhciBSRVBPU0lUT1JZX0FOR1VMQVJfT1RIRVIgPSAnJGFuZ3VsYXItb3RoZXInOw0KDQpleHBvcnRzLmluc3RhbGwgPSBmdW5jdGlvbihmcmFtZXdvcmssIG9wdGlvbnMpIHsNCg0KICAgIFV0aWxzLmV4dGVuZChleHBvcnRzLm9wdGlvbnMsIG9wdGlvbnMsIHRydWUpOw0KDQogICAgLyoNCiAgICAgICAgSW5jbHVkZTogQW5ndWxhci5qcyBDRE4gaW50byB0aGUgaGVhZA0KICAgICAgICBAdmVyc2lvbiB7U3RyaW5nfQ0KICAgICAgICBAbmFtZSB7U3RyaW5nIG9yIFN0cmluZyBBcnJheX0gOjogb3B0aW9uYWwsIGV4YW1wbGU6IHJvdXRlIG9yIHJlc291cmNlDQogICAgICAgIHJldHVybiB7U3RyaW5nfQ0KICAgICovDQogICAgZnJhbWV3b3JrLmhlbHBlcnMubmcgPSBmdW5jdGlvbihuYW1lKSB7DQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCg0KICAgICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsNCiAgICAgICAgaWYgKGxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmcuY2FsbChzZWxmLCBhcmd1bWVudHNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgbGVuZ3RoID0gbmFtZS5sZW5ndGg7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nLmNhbGwoc2VsZiwgbmFtZVtpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgaXNDb21tb24gPSBuYW1lWzBdID09PSAnfic7DQoNCiAgICAgICAgaWYgKGlzQ29tbW9uKQ0KICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDEpOw0KDQogICAgICAgIGlmIChuYW1lID09PSB1bmRlZmluZWQpDQogICAgICAgICAgICBuYW1lID0gJ2FuZ3VsYXInOw0KDQogICAgICAgIGlmIChuYW1lID09PSAnY29yZScgfHwgbmFtZSA9PT0gJycgfHwgbmFtZSA9PT0gJ2Jhc2UnIHx8IG5hbWUgPT09ICdtYWluJykNCiAgICAgICAgICAgIG5hbWUgPSAnYW5ndWxhcic7DQoNCiAgICAgICAgaWYgKG5hbWUgIT09ICdhbmd1bGFyJyAmJiBuYW1lLmluZGV4T2YoJ2FuZ3VsYXItJykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSA9ICdhbmd1bGFyLScgKyBuYW1lOw0KDQogICAgICAgIHZhciBvdXRwdXQgPSBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSXSB8fCAnJzsNCiAgICAgICAgdmFyIHNjcmlwdCA9ICRzY3JpcHRfY3JlYXRlKChpc0NvbW1vbiA/ICcvY29tbW9uLycgKyBuYW1lICsgJy5taW4uanMnIDogJy8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2FuZ3VsYXIuanMvJyArIGV4cG9ydHMub3B0aW9uc1snYW5ndWxhci12ZXJzaW9uJ10gKyAnLycgKyBuYW1lICsgJy5taW4uanMnKSk7DQoNCiAgICAgICAgaWYgKG5hbWUgPT09ICdhbmd1bGFyJykNCiAgICAgICAgICAgIG91dHB1dCA9IHNjcmlwdCArIG91dHB1dDsNCiAgICAgICAgZWxzZQ0KICAgICAgICAgICAgb3V0cHV0ICs9IHNjcmlwdDsNCg0KICAgICAgICBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSXSA9IG91dHB1dDsNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH07DQoNCg0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nQ29tbW9uID0gZnVuY3Rpb24obmFtZSkgew0KDQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7DQoNCiAgICAgICAgaWYgKGxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgc2VsZi5uZ0NvbW1vbi5jYWxsKHNlbGYsIGFyZ3VtZW50c1tpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobmFtZSBpbnN0YW5jZW9mIEFycmF5KSB7DQogICAgICAgICAgICBsZW5ndGggPSBuYW1lLmxlbmd0aDsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgc2VsZi5uZ0NvbW1vbi5jYWxsKHNlbGYsIG5hbWVbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIG91dHB1dCA9IHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfQ09NTU9OXSB8fCAnJzsNCg0KICAgICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZihFWFRFTlNJT05fSlMpID09PSAtMSkNCiAgICAgICAgICAgIG5hbWUgKz0gRVhURU5TSU9OX0pTOw0KDQogICAgICAgIHZhciBzY3JpcHQgPSAkc2NyaXB0X2NyZWF0ZSgnL2NvbW1vbi8nICsgbmFtZSk7DQogICAgICAgIG91dHB1dCArPSBzY3JpcHQ7DQoNCiAgICAgICAgc2VsZi5yZXBvc2l0b3J5W1JFUE9TSVRPUllfQU5HVUxBUl9DT01NT05dID0gb3V0cHV0Ow0KICAgICAgICByZXR1cm4gJyc7DQogICAgfTsNCg0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nTG9jYWxlID0gZnVuY3Rpb24obmFtZSkgew0KDQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7DQoNCiAgICAgICAgaWYgKGxlbmd0aCA+IDIpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmdMb2NhbGUuY2FsbChzZWxmLCBhcmd1bWVudHNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgbGVuZ3RoID0gbmFtZS5sZW5ndGg7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nTG9jYWxlLmNhbGwoc2VsZiwgbmFtZVtpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICB2YXIgb3V0cHV0ID0gc2VsZi5yZXBvc2l0b3J5W1JFUE9TSVRPUllfQU5HVUxBUl9MT0NBTEVdIHx8ICcnOw0KICAgICAgICB2YXIgaXNMb2NhbCA9IG5hbWVbMF0gPT09ICd+JzsNCiAgICAgICAgdmFyIGV4dGVuc2lvbiA9ICcnOw0KDQogICAgICAgIGlmIChpc0xvY2FsKQ0KICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDEpOw0KDQogICAgICAgIGlmIChuYW1lLmluZGV4T2YoJ2FuZ3VsYXItbG9jYWxlXycpICE9PSAtMSkNCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoJ2FuZ3VsYXItbG9jYWxlXycsICcnKTsNCg0KICAgICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZihFWFRFTlNJT05fSlMpID09PSAtMSkNCiAgICAgICAgICAgIGV4dGVuc2lvbiA9IEVYVEVOU0lPTl9KUzsNCg0KICAgICAgICBvdXRwdXQgKz0gJHNjcmlwdF9jcmVhdGUoaXNMb2NhbCA/ICcvaTE4bi9hbmd1bGFyLWxvY2FsZV8nICsgbmFtZSArIGV4dGVuc2lvbiA6ICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9hbmd1bGFyLWkxOG4vJyArIGV4cG9ydHMub3B0aW9uc1snYW5ndWxhci1pMThuLXZlcnNpb24nXSArICcvYW5ndWxhci1sb2NhbGVfJyArIG5hbWUgKyBleHRlbnNpb24pOw0KICAgICAgICBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX0xPQ0FMRV0gPSBvdXRwdXQ7DQoNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH07DQoNCiAgICAvKg0KICAgICAgICBJbmNsdWRlOiBDb250cm9sbGVyIGludG8gdGhlIGhlYWQNCiAgICAgICAgQG5hbWUge1N0cmluZyBvciBTdHJpbmcgQXJyYXl9DQogICAgICAgIHJldHVybiB7U3RyaW5nfQ0KICAgICovDQogICAgZnJhbWV3b3JrLmhlbHBlcnMubmdDb250cm9sbGVyID0gZnVuY3Rpb24obmFtZSkgew0KDQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCg0KICAgICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsNCiAgICAgICAgaWYgKGxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmdDb250cm9sbGVyLmNhbGwoc2VsZiwgYXJndW1lbnRzW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChuYW1lIGluc3RhbmNlb2YgQXJyYXkpIHsNCiAgICAgICAgICAgIGxlbmd0aCA9IG5hbWUubGVuZ3RoOw0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykNCiAgICAgICAgICAgICAgICBmcmFtZXdvcmsuaGVscGVycy5uZ0NvbnRyb2xsZXIuY2FsbChzZWxmLCBuYW1lW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKEVYVEVOU0lPTl9KUykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSArPSBFWFRFTlNJT05fSlM7DQoNCiAgICAgICAgdmFyIG91dHB1dCA9IHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfQ09OVFJPTExFUl0gfHwgJyc7DQogICAgICAgIHZhciBpc0xvY2FsID0gbmFtZVswXSA9PT0gJ34nOw0KDQogICAgICAgIGlmIChpc0xvY2FsKQ0KICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDEpOw0KDQogICAgICAgIG91dHB1dCArPSAkc2NyaXB0X2NyZWF0ZSgnL2NvbnRyb2xsZXJzLycgKyBuYW1lKTsNCg0KICAgICAgICBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX0NPTlRST0xMRVJdID0gb3V0cHV0Ow0KDQogICAgICAgIHJldHVybiAnJzsNCiAgICB9Ow0KDQogICAgLyoNCiAgICAgICAgSW5jbHVkZTogQ29udGVudCBmcm9tIGZpbGUgaW50byB0aGUgYm9keQ0KICAgICAgICBAbmFtZSB7U3RyaW5nfQ0KICAgICAgICByZXR1cm4ge1N0cmluZ30NCiAgICAqLw0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nVGVtcGxhdGUgPSBmdW5jdGlvbihuYW1lLCBpZCkgew0KDQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCg0KICAgICAgICBpZiAoaWQgPT09IHVuZGVmaW5lZCkNCiAgICAgICAgICAgIGlkID0gbmFtZTsNCg0KICAgICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZignLmh0bWwnKSA9PT0gLTEpDQogICAgICAgICAgICBuYW1lICs9ICcuaHRtbCc7DQoNCiAgICAgICAgaWYgKG5hbWVbMF0gPT09ICd+JykNCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsNCiAgICAgICAgZWxzZSBpZiAobmFtZVsxXSAhPT0gJy8nKQ0KICAgICAgICAgICAgbmFtZSA9ICcvdGVtcGxhdGVzLycgKyBuYW1lOw0KDQogICAgICAgIHZhciBrZXkgPSAnbmctJyArIG5hbWU7DQogICAgICAgIHZhciB0bXAgPSBmcmFtZXdvcmsudGVtcG9yYXJ5LnZpZXdzW2tleV07DQoNCiAgICAgICAgaWYgKHRtcCA9PT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICB2YXIgZmlsZW5hbWUgPSB1dGlscy5jb21iaW5lKHNlbGYuY29uZmlnWydkaXJlY3RvcnktcHVibGljLXZpcnR1YWwnXSwgbmFtZSk7DQoNCiAgICAgICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGZpbGVuYW1lKSkNCiAgICAgICAgICAgICAgICB0bXAgPSBmcy5yZWFkRmlsZVN5bmMoZmlsZW5hbWUpLnRvU3RyaW5nKCd1dGY4Jyk7DQogICAgICAgICAgICBlbHNlDQogICAgICAgICAgICAgICAgdG1wID0gJyc7DQoNCiAgICAgICAgICAgIGlmICghc2VsZi5pc0RlYnVnKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay50ZW1wb3Jhcnkudmlld3Nba2V5XSA9IHRtcDsNCiAgICAgICAgfQ0KDQogICAgICAgIHJldHVybiAnPHNjcmlwdCB0eXBlPSJ0ZXh0L25nLXRlbXBsYXRlIiBpZD0iJyArIGlkICsgJyI+JyArIHRtcCArICc8L3NjcmlwdD4nOw0KICAgIH07DQoNCiAgICAvKg0KICAgICAgICBJbmNsdWRlOiBEaXJlY3RpdmUgaW50byB0aGUgaGVhZA0KICAgICAgICBAbmFtZSB7U3RyaW5nfQ0KICAgICAgICByZXR1cm4ge1N0cmluZ30NCiAgICAqLw0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nRGlyZWN0aXZlID0gZnVuY3Rpb24obmFtZSkgew0KDQogICAgICAgIHZhciBzZWxmID0gdGhpczsNCg0KICAgICAgICB2YXIgbGVuZ3RoID0gYXJndW1lbnRzLmxlbmd0aDsNCiAgICAgICAgaWYgKGxlbmd0aCA+IDEpIHsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmdEaXJlY3RpdmUuY2FsbChzZWxmLCBhcmd1bWVudHNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgbGVuZ3RoID0gbmFtZS5sZW5ndGg7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nRGlyZWN0aXZlLmNhbGwoc2VsZiwgbmFtZVtpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZihFWFRFTlNJT05fSlMpID09PSAtMSkNCiAgICAgICAgICAgIG5hbWUgKz0gRVhURU5TSU9OX0pTOw0KDQogICAgICAgIHZhciBvdXRwdXQgPSBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX09USEVSXSB8fCAnJzsNCiAgICAgICAgdmFyIGlzTG9jYWwgPSBuYW1lWzBdID09PSAnfic7DQoNCiAgICAgICAgaWYgKGlzTG9jYWwpDQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7DQoNCiAgICAgICAgb3V0cHV0ICs9ICRzY3JpcHRfY3JlYXRlKCcvZGlyZWN0aXZlcy8nICsgbmFtZSk7DQogICAgICAgIHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfT1RIRVJdID0gb3V0cHV0Ow0KICAgICAgICByZXR1cm4gJyc7DQogICAgfTsNCg0KICAgIC8qDQogICAgICAgIEluY2x1ZGU6IENTUyBpbnRvIHRoZSBoZWFkDQogICAgICAgIEBuYW1lIHtTdHJpbmd9DQogICAgICAgIHJldHVybiB7U3RyaW5nfQ0KICAgICovDQogICAgZnJhbWV3b3JrLmhlbHBlcnMubmdTdHlsZSA9IGZ1bmN0aW9uKG5hbWUpIHsNCg0KICAgICAgICB2YXIgc2VsZiA9IHRoaXM7DQogICAgICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOw0KDQogICAgICAgIGlmIChsZW5ndGggPiAxKSB7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nU3R5bGUuY2FsbChzZWxmLCBhcmd1bWVudHNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgbGVuZ3RoID0gbmFtZS5sZW5ndGg7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nU3R5bGUuY2FsbChzZWxmLCBuYW1lW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKCcuY3NzJykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSArPSAnLmNzcyc7DQoNCiAgICAgICAgc2VsZi5oZWFkKG5hbWUpOw0KICAgICAgICByZXR1cm4gJyc7DQogICAgfTsNCg0KICAgIC8qDQogICAgICAgIEluY2x1ZGU6IFNlcnZpY2UgaW50byB0aGUgaGVhZA0KICAgICAgICBAbmFtZSB7U3RyaW5nfQ0KICAgICAgICByZXR1cm4ge1N0cmluZ30NCiAgICAqLw0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nU2VydmljZSA9IGZ1bmN0aW9uKG5hbWUpIHsNCg0KICAgICAgICB2YXIgc2VsZiA9IHRoaXM7DQoNCiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7DQogICAgICAgIGlmIChsZW5ndGggPiAxKSB7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nU2VydmljZS5jYWxsKHNlbGYsIGFyZ3VtZW50c1tpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobmFtZSBpbnN0YW5jZW9mIEFycmF5KSB7DQogICAgICAgICAgICBsZW5ndGggPSBuYW1lLmxlbmd0aDsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmdTZXJ2aWNlLmNhbGwoc2VsZiwgbmFtZVtpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobmFtZS5sYXN0SW5kZXhPZihFWFRFTlNJT05fSlMpID09PSAtMSkNCiAgICAgICAgICAgIG5hbWUgKz0gRVhURU5TSU9OX0pTOw0KDQogICAgICAgIHZhciBvdXRwdXQgPSBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX09USEVSXSB8fCAnJzsNCiAgICAgICAgdmFyIGlzTG9jYWwgPSBuYW1lWzBdID09PSAnfic7DQoNCiAgICAgICAgaWYgKGlzTG9jYWwpDQogICAgICAgICAgICBuYW1lID0gbmFtZS5zdWJzdHJpbmcoMSk7DQoNCiAgICAgICAgb3V0cHV0ICs9ICRzY3JpcHRfY3JlYXRlKCcvc2VydmljZXMvJyArIG5hbWUpOw0KICAgICAgICBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX09USEVSXSA9IG91dHB1dDsNCg0KICAgICAgICByZXR1cm4gJyc7DQogICAgfTsNCg0KICAgIC8qDQogICAgICAgIEluY2x1ZGU6IEZpbHRlciBpbnRvIHRoZSBoZWFkDQogICAgICAgIEBuYW1lIHtTdHJpbmd9DQogICAgICAgIHJldHVybiB7U3RyaW5nfQ0KICAgICovDQogICAgZnJhbWV3b3JrLmhlbHBlcnMubmdGaWx0ZXIgPSBmdW5jdGlvbihuYW1lKSB7DQoNCiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOw0KDQogICAgICAgIHZhciBsZW5ndGggPSBhcmd1bWVudHMubGVuZ3RoOw0KICAgICAgICBpZiAobGVuZ3RoID4gMSkgew0KICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykNCiAgICAgICAgICAgICAgICBmcmFtZXdvcmsuaGVscGVycy5uZ0ZpbHRlci5jYWxsKHNlbGYsIGFyZ3VtZW50c1tpXSk7DQogICAgICAgICAgICByZXR1cm4gJyc7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAobmFtZSBpbnN0YW5jZW9mIEFycmF5KSB7DQogICAgICAgICAgICBsZW5ndGggPSBuYW1lLmxlbmd0aDsNCiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspDQogICAgICAgICAgICAgICAgZnJhbWV3b3JrLmhlbHBlcnMubmdGaWx0ZXIuY2FsbChzZWxmLCBuYW1lW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKEVYVEVOU0lPTl9KUykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSArPSBFWFRFTlNJT05fSlM7DQoNCiAgICAgICAgdmFyIG91dHB1dCA9IHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfT1RIRVJdIHx8ICcnOw0KICAgICAgICB2YXIgaXNMb2NhbCA9IG5hbWVbMF0gPT09ICd+JzsNCg0KICAgICAgICBpZiAoaXNMb2NhbCkNCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsNCg0KICAgICAgICBvdXRwdXQgKz0gJHNjcmlwdF9jcmVhdGUoJy9maWx0ZXJzLycgKyBuYW1lKTsNCiAgICAgICAgc2VsZi5yZXBvc2l0b3J5W1JFUE9TSVRPUllfQU5HVUxBUl9PVEhFUl0gPSBvdXRwdXQ7DQoNCiAgICAgICAgcmV0dXJuICcnOw0KICAgIH07DQoNCiAgICAvKg0KICAgICAgICBJbmNsdWRlOiBSZXNvdXJjZSBpbnRvIHRoZSBoZWFkDQogICAgICAgIEBuYW1lIHtTdHJpbmd9DQogICAgICAgIHJldHVybiB7U3RyaW5nfQ0KICAgICovDQogICAgZnJhbWV3b3JrLmhlbHBlcnMubmdSZXNvdXJjZSA9IGZ1bmN0aW9uKG5hbWUpIHsNCg0KICAgICAgICB2YXIgc2VsZiA9IHRoaXM7DQoNCiAgICAgICAgdmFyIGxlbmd0aCA9IGFyZ3VtZW50cy5sZW5ndGg7DQogICAgICAgIGlmIChsZW5ndGggPiAxKSB7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nUmVzb3VyY2UuY2FsbChzZWxmLCBhcmd1bWVudHNbaV0pOw0KICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkgew0KICAgICAgICAgICAgbGVuZ3RoID0gbmFtZS5sZW5ndGg7DQogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKQ0KICAgICAgICAgICAgICAgIGZyYW1ld29yay5oZWxwZXJzLm5nUmVzb3VyY2UuY2FsbChzZWxmLCBuYW1lW2ldKTsNCiAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKEVYVEVOU0lPTl9KUykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSArPSBFWFRFTlNJT05fSlM7DQoNCiAgICAgICAgdmFyIG91dHB1dCA9IHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfT1RIRVJdIHx8ICcnOw0KICAgICAgICB2YXIgaXNMb2NhbCA9IG5hbWVbMF0gPT09ICd+JzsNCg0KICAgICAgICBpZiAoaXNMb2NhbCkNCiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnN1YnN0cmluZygxKTsNCg0KICAgICAgICBvdXRwdXQgKz0gJHNjcmlwdF9jcmVhdGUoJy9yZXNvdXJjZXMvJyArIG5hbWUpOw0KICAgICAgICBzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX09USEVSXSA9IG91dHB1dDsNCg0KICAgICAgICByZXR1cm4gJyc7DQogICAgfTsNCg0KICAgIGZyYW1ld29yay5oZWxwZXJzLm5nSW5jbHVkZSA9IGZ1bmN0aW9uKG5hbWUpIHsNCiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOw0KDQogICAgICAgIGlmIChuYW1lLmxhc3RJbmRleE9mKEVYVEVOU0lPTl9KUykgPT09IC0xKQ0KICAgICAgICAgICAgbmFtZSArPSBFWFRFTlNJT05fSlM7DQoNCiAgICAgICAgcmV0dXJuICRzY3JpcHRfY3JlYXRlKG5hbWUpOw0KICAgIH07DQoNCiAgICBmcmFtZXdvcmsub24oJ2NvbnRyb2xsZXItcmVuZGVyLWhlYWQnLCBldmVudF9yZW5kZXJfaGVhZCk7DQp9Ow0KDQpleHBvcnRzLnVuaW5zdGFsbCA9IGZ1bmN0aW9uKGZyYW1ld29yaykgew0KICAgIGRlbGV0ZSBmcmFtZXdvcmsuaGVscGVycy5uZzsNCiAgICBkZWxldGUgZnJhbWV3b3JrLmhlbHBlcnMubmdJbmNsdWRlOw0KICAgIGRlbGV0ZSBmcmFtZXdvcmsuaGVscGVycy5uZ1Jlc291cmNlOw0KICAgIGRlbGV0ZSBmcmFtZXdvcmsuaGVscGVycy5uZ0ZpbHRlcjsNCiAgICBkZWxldGUgZnJhbWV3b3JrLmhlbHBlcnMubmdTZXJ2aWNlOw0KICAgIGRlbGV0ZSBmcmFtZXdvcmsuaGVscGVycy5uZ0RpcmVjdGl2ZTsNCiAgICBkZWxldGUgZnJhbWV3b3JrLmhlbHBlcnMubmdUZW1wbGF0ZTsNCiAgICBkZWxldGUgZnJhbWV3b3JrLmhlbHBlcnMubmdDb250cm9sbGVyOw0KICAgIGRlbGV0ZSBmcmFtZXdvcmsuaGVscGVycy5uZ0xvY2FsZTsNCiAgICBkZWxldGUgZnJhbWV3b3JrLmhlbHBlcnMubmdDb21tb247DQogICAgZnJhbWV3b3JrLnJlbW92ZUxpc3RlbmVyKCdjb250cm9sbGVyLXJlbmRlci1oZWFkJywgZXZlbnRfcmVuZGVyX2hlYWQpOw0KfTsNCg0KZnVuY3Rpb24gZXZlbnRfcmVuZGVyX2hlYWQoY29udHJvbGxlcikgew0KICAgIHZhciBzZWxmID0gY29udHJvbGxlcjsNCiAgICB2YXIgYW5ndWxhckJlZyA9IChzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSXSB8fCAnJykgKyAoc2VsZi5yZXBvc2l0b3J5W1JFUE9TSVRPUllfQU5HVUxBUl9DT01NT05dIHx8ICcnKSArIChzZWxmLnJlcG9zaXRvcnlbUkVQT1NJVE9SWV9BTkdVTEFSX0xPQ0FMRV0gfHwgJycpOw0KICAgIHZhciBhbmd1bGFyRW5kID0gKGFuZ3VsYXJCZWcubGVuZ3RoID4gMCA/ICRzY3JpcHRfY3JlYXRlKCcvYXBwLmpzJykgOiAnJykgKyAoc2VsZi5yZXBvc2l0b3J5W1JFUE9TSVRPUllfQU5HVUxBUl9PVEhFUl0gfHwgJycpICsgKHNlbGYucmVwb3NpdG9yeVtSRVBPU0lUT1JZX0FOR1VMQVJfQ09OVFJPTExFUl0gfHwgJycpOw0KICAgIHNlbGYucmVwb3NpdG9yeVsnJGhlYWQnXSArPSBhbmd1bGFyQmVnICsgYW5ndWxhckVuZDsNCn0NCg0KZnVuY3Rpb24gJHNjcmlwdF9jcmVhdGUodXJsKSB7DQogICAgcmV0dXJuICc8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSInICsgdXJsICsgJyI+PC9zY3JpcHQ+JzsNCn0=","base64");buffer=[];buffer.push("var app = angular.module('app', []);");buffer.push("");fs.writeFileSync(path.join(dir,"app.js"),buffer.join(EOF));buffer=[];buffer.push("function HomeCtrl($scope) {\n    $scope.name = 'total.js + angular.js = awesome';\n}");fs.writeFileSync(path.join(controllers,"home.js"),buffer.join(EOF));buffer=[];buffer.push("function UserCtrl($scope) {\n    // example\n}");fs.writeFileSync(path.join(controllers,"user.js"),buffer.join(EOF))}function createFilePublic(directory){var dir=path.join(directory,"public");var css=path.join(dir,"css");var js=path.join(dir,"js");var img=path.join(dir,"img");fs.writeFileSync(path.join(dir,"favicon.ico"),"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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA","base64");
if($type===3)return;if(!fs.existsSync(js))fs.mkdirSync(js);if(!fs.existsSync(css))fs.mkdirSync(css);if(!fs.existsSync(img))fs.mkdirSync(img);var buffer=[];buffer.push("User-agent: *");buffer.push("Allow: /");buffer.push("");fs.writeFileSync(path.join(dir,"robots.txt"),buffer.join(EOF));fs.writeFileSync(path.join(css,"default.css"),"LyphdXRvKi8NCg0KYm9keSB7IHBhZGRpbmc6MjBweDsgbWFyZ2luOjA7IGZvbnQ6bm9ybWFsIDEycHggQXJpYWw7IGNvbG9yOiM1MDUwNTA7IH0NCg0KLmNvbnRlbnQgeyBtYXJnaW46MCBhdXRvOyB3aWR0aDogOTYwcHg7IHBhZGRpbmc6IDEwcHg7IGJvcmRlci1yYWRpdXM6IDVweDsgYm94LXNoYWRvdzogMCAwIDIwcHggcmdiYSgwLDAsMCwwLjUpOyBhbmltYXRpb246IG15QW5pbWF0aW9uIDVzIGFsdGVybmF0ZTsgfQ0KDQoubGlzdCB7IGJvcmRlci1ib3R0b206MXB4IHNvbGlkICNFMEUwRTA7IHBhZGRpbmctYm90dG9tOjVweDsgbWFyZ2luLWJvdHRvbTo1cHg7IH0NCi5saXN0ID4gZGl2OmZpcnN0LWNoaWxkIHsgZm9udC1zaXplOiAxNXB4OyB9DQoNCkBrZXlmcmFtZXMgbXlBbmltYXRpb24NCnsNCgkwJSAgIHsgYmFja2dyb3VuZDogd2hpdGU7IH0NCgkyNSUgIHsgYmFja2dyb3VuZDogI0YwRjBGMDsgfQ0KCTUwJSAgeyBiYWNrZ3JvdW5kOiAjRDBEMEQwOyB9DQoJMTAwJSB7IGJhY2tncm91bmQ6ICNFMEUwRTA7IH0NCn0=","base64");buffer=[];buffer.push("$(document).ready(function() {");buffer.push("");buffer.push("});");fs.writeFileSync(path.join(js,"default.js"),buffer.join(EOF))}function createFileModules(directory){var dir=path.join(directory,"modules");fs.writeFileSync(path.join(dir,"example.js"),"Ly8gSW1wb3J0YW50DQpleHBvcnRzLmlkID0gJ2V4YW1wbGUnOw0KDQovLyBPcHRpb25hbA0KZXhwb3J0cy5pbnN0YWxsID0gZnVuY3Rpb24oZnJhbWV3b3JrLCBvcHRpb25zKSB7DQoNCn07DQoNCi8vIE9wdGlvbmFsDQpleHBvcnRzLnVuaW5zdGFsbCA9IGZ1bmN0aW9uKGZyYW1ld29yaywgb3B0aW9ucykgew0KDQp9Ow0KDQovLyBPcHRpb25hbA0KZXhwb3J0cy51c2FnZSA9IGZ1bmN0aW9uKCkgew0KICAgIHJldHVybiB7fTsNCn07DQoNCmV4cG9ydHMueW91cmNvZGUgPSBmdW5jdGlvbigpIHsNCiAgICByZXR1cm4gJ0hlbGxvIFdvcmxkJzsNCn07","base64")}function createFileControllerAngular(directory){var dir=path.join(directory,"controllers");var buffer=[];buffer.push("exports.install = function(framework) {");buffer.push("    framework.route('/*', view_app);");buffer.push("};");buffer.push("");buffer.push("function view_app() {");buffer.push("    var self = this;");buffer.push("    self.view('app');");buffer.push("}");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileController(directory){var dir=path.join(directory,"controllers");var buffer=[];buffer.push("exports.install = function(framework) {");buffer.push("    framework.route('/', view_index);");if($type!==2){buffer.push("    // or");buffer.push("    // framework.route('/');")}buffer.push("};");buffer.push("");buffer.push("function view_index() {");buffer.push("    var self = this;");if($type!==2)buffer.push("    self.view('index');");else buffer.push("    self.plain('index');");buffer.push("}");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function createFileTest(directory){var dir=path.join(directory,"tests");var buffer=[];buffer.push("var assert = require('assert');");buffer.push("");buffer.push("exports.priority = 1;");buffer.push("exports.disabled = false;");buffer.push("");buffer.push("exports.run = function(framework) {");buffer.push("");buffer.push("    framework.assert('Number validation', function(next, name) {");buffer.push("        assert.ok('1' === '1', name);");buffer.push("        next();");buffer.push("    });");buffer.push("");buffer.push("    framework.assert('Some controller action', '/some-url-action/', ['xhr', 'json'], function(error, data, code, headers, cookies, name) {");buffer.push("        assert.ok(code === 200, name);");buffer.push("    }, { name: 'total.js (optional)' }, { cookie: 'value (optional)' }, { 'X-My-Header': 'optional' });");buffer.push("");buffer.push("};");fs.writeFileSync(path.join(dir,"default.js"),buffer.join(EOF))}function install(directory){exec("npm install total.js",{cwd:directory},function(error,stdout,stderr){}).on("exit",function(){console.log("total.js: success")})}function display_help(){console.log("");console.log("-m or -minimal   = minimal");console.log("-n or -normal    = normal (default)");console.log("-f or -full      = full");console.log("-a or -angular   = for angular.js application");console.log("-v or -version   = total.js version");console.log("/path/           = target (default current directory)");console.log("")}function main(){var dir=process.cwd();for(var i=2;i<process.argv.length;i++){var arg=process.argv[i];var cmd=arg.toLowerCase();if(cmd==="-v"||cmd==="-version"){console.log(require("total.js").version);return}if(cmd==="-f"||cmd==="-full"||cmd==="full")continue;if(cmd==="-a"||cmd==="-angular"||cmd==="angular"){$type=3;continue}if(cmd==="-m"||cmd==="-minimal"||cmd==="-minimum"||cmd==="minimum"){$type=2;continue}if(cmd==="-n"||cmd==="-normal"||cmd==="normal"){$type=1;continue}if(cmd==="-h"||cmd==="-help"||cmd==="--help"||cmd==="help"){display_help();return}dir=arg;break}$type=2;if(!fs.existsSync(dir)){console.log("total.js: error / directory not exists");return}var files=fs.readdirSync(dir);if(files.length>0){var can=true;for(var i=0;i<files.length;i++){var name=files[i];if(name[0]===".")continue;can=false}if(!can){console.log("total.js: error / directory is not empty");return}}console.log("total.js: creating directories");if($type!==3)createDirectory(dir);else createDirectoryAngular(dir);console.log("total.js: creating files");createFiles(dir);console.log("total.js: installing current version total.js");install(dir)}main();